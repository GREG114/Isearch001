@{
    ViewData["Title"] = "CRM数据分析";
}

<button class="btn btn-outline-primary" onclick="load()">加载</button>
<script src="https://cdn.bootcss.com/echarts/4.4.0-rc.1/echarts.min.js"></script>
<div id="main" style="width: 1100px;height:600px;"></div>

<script>
    var strlist = []

    var countlist = []

    var myChart = echarts.init(document.getElementById('main'));


    function com(str) {

        var test = strlist.filter()

        for (var i in strlist) {
            // alert(strlist[i]+'||'+str)
            if (strlist[i] == str) {

                return true;
            }
        }
        return false
    }
    //阶段, logcount, currentcount
    function load() {
        $.ajax({
            type: "get",
            url: "/CRMAnalysis/CrmLog1",
            success: function (e) {
                //返回值是一个jsonarray可以直接取值或者取子对象
                //stringify是将其中的json对象反序列化为字符串
                strlist = e["阶段"]
                passlist=e["logcount"]
                countlist = e["currentcount"]
                option = {
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                            type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    legend: {
                        data: ['实际数量','已推进数量']
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'value'
                    },
                    yAxis: {
                        type: 'category',
                        data: strlist
                    },
                    series: [
                        {
                            name: '实际数量',
                            type: 'bar',
                            stack: '总量',
                            label: {
                                show: true,
                                position: 'insideRight'
                            },
                            data: countlist
                        },{
                            name: '已推进数量',
                            type: 'bar',
                            stack: '总量',
                            //label: {
                            //    show: true,
                            //    position: 'insideRight'
                            //},不要标签，否则数字标识重叠
                            data: passlist
                        }
                    ]
                };
                myChart.setOption(option);
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
            }
        })
    }

    window.onload = function () {
        load()
    }
</script>




@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
